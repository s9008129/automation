# 任務審查報告

## 檢查摘要（給非技術人員）
本次審查確認錄製檔的密碼清理已改為「只寫入字面上的佔位符」，不會把真實密碼寫回檔案；錄製視窗關閉後也會提示下一步選擇；文件與 .env 載入行為皆符合規範。已補上一處小差異（佔位符字串更精確），TypeScript 檢查通過。

## 檢查結果與重點
1) **sanitizeRecording() 密碼清理**  
   - 結論：已符合「只寫入字面上的 process.env.RECORDING_PASSWORD」的要求。  
   - 程式碼位置：`collect-materials.ts`（約 1065 行附近，sanitizeRecording）。  

2) **collectInteractive() 錄製完成後的下一步提示**  
   - 結論：已在錄製完成且 Codegen 視窗關閉後，提示「接下來要做什麼？」並提供選項（繼續／重新錄製／擷取 ARIA／結束）。  
   - 程式碼位置：`collect-materials.ts`（約 1337 行附近，collectInteractive 內）。  

3) **文件更新狀態（使用指南 / 規格）**  
   - 結論：`docs/使用指南.md` 與 `docs/spec.md` 已描述 sanitize 原則、ARIA-first 流程、與關閉 Codegen 後的下一步 UX。  

4) **loadDotEnv() 啟動載入 .env**  
   - 結論：已在啟動時呼叫 `loadDotEnv()`；`.env` 已列入 `.gitignore`，不會被提交。  
   - 程式碼位置：`collect-materials.ts`（約 1560 行附近）。  

5) **TypeScript 檢查**  
   - `npx tsc --noEmit`：**通過**。  

## 發現的缺失
1) **佔位符字串不夠精確（已修正）**  
   - 原狀：錄製檔會被替換成 `process.env.RECORDING_PASSWORD || ''`，雖不會寫入真實值，但不夠精確符合「只寫入字面上的佔位符」要求。  
   - 影響：與規格文字不完全一致。  

## 已做的修改
- `sanitizeRecording()` 改為寫入**精確的**字面量 `process.env.RECORDING_PASSWORD`（不含 `|| ''`）。  

## 後續建議
- 建議在錄製完成後，使用者可手動打開錄製檔快速確認 `.fill(...)` 已是 `process.env.RECORDING_PASSWORD`，避免誤植。  
- 若需更嚴格保障，可在 Pre-commit 掃描中加上「禁止出現 `|| ''`」的檢查規則（非必要）。  

## QA 檢查清單（簡單步驟）
1. 執行互動模式 `npm run collect`，完成一頁擷取後選 `r` 進入錄製。  
2. 關閉 Codegen 視窗後，確認 CLI 顯示「接下來要做什麼？」並有選項（繼續／重新錄製／擷取 ARIA／結束）。  
3. 打開產生的錄製檔（`materials\recordings\*.ts`），確認密碼欄位是 `process.env.RECORDING_PASSWORD` 的字面佔位符。  
4. 執行 `npx tsc --noEmit`，確認無 TypeScript 錯誤。  
5. 執行 `git status`，確認 `.env` 未被追蹤。  

